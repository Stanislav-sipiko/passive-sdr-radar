# üéß passive_radar/capture

–ú–æ–¥—É–ª—å **–ø—Ä–∏—ë–º–∞ –∏ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ IQ-–¥–∞–Ω–Ω—ã—Ö** –æ—Ç –ø—Ä–∏—ë–º–Ω–∏–∫–æ–≤ **KrakenSDR**.  
–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ (–¥–æ 5) –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö –≤ CAF-–º–æ–¥—É–ª—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞.

---

## üìÑ –§–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------------|
| **`kraken_reader.py`** | –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å KrakenSDR |
| **`__init__.py`** | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–º–æ–¥—É–ª—è |

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

| –†–µ–∂–∏–º | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|
| `file` | –ß—Ç–µ–Ω–∏–µ –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`.bin`) —Å IQ-–¥–∞–Ω–Ω—ã–º–∏. |
| `udp`  | –ü—Ä–∏—ë–º –ø–æ—Ç–æ–∫–æ–≤—ã—Ö IQ-–¥–∞–Ω–Ω—ã—Ö –æ—Ç KrakenSDR –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ UDP. |

–ö–∞–∂–¥—ã–π —Å—ç–º–ø–ª ‚Äî –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —á–∏—Å–ª–æ (`I`, `Q`), –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ —Ç–∏–ø–æ–º `complex64`.

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã

```
[ KrakenSDR ] ‚Üí UDP ‚Üí [ Raspberry Pi 5 ]
                    ‚Ü≥ kraken_reader.py
                        ‚îú‚îÄ‚îÄ Shared Memory Buffer (5 –∫–∞–Ω–∞–ª–æ–≤)
                        ‚îú‚îÄ‚îÄ UDP Reader (–ø—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö)
                        ‚îî‚îÄ‚îÄ 5 CAF Workers (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–Ω–∞–ª–æ–≤)
```

- **UDP Reader** ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç IQ-–¥–∞–Ω–Ω—ã–µ –æ—Ç SDR –∏ –ø–∏—à–µ—Ç –≤ –æ–±—â—É—é –ø–∞–º—è—Ç—å.  
- **Shared Memory** ‚Äî –æ–±—â–∞—è –æ–±–ª–∞—Å—Ç—å, –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.  
- **CAF Workers (√ó5)** ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–Ω–∞–ª–æ–≤ (–æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –∫–∞–Ω–∞–ª).  
- **Event Sync** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —á—Ç–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞.  

---

## üöÄ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ß—Ç–µ–Ω–∏–µ IQ-—Ñ–∞–π–ª–∞
```python
from passive_radar.capture.kraken_reader import get_iq_source

for block in get_iq_source(mode="file", file_path="data/test_iq.bin"):
    print(block[:5])
```

### –ü—Ä–∏—ë–º UDP-–ø–æ—Ç–æ–∫–∞
```python
from passive_radar.capture.kraken_reader import get_iq_source

for block in get_iq_source(mode="udp", host="0.0.0.0", port=5000):
    print(f"–ü–æ–ª—É—á–µ–Ω –±–ª–æ–∫: {len(block)}")
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –ü–æ—Ç–æ–∫–æ–≤ | FPS CAF | –ù–∞–≥—Ä—É–∑–∫–∞ CPU |
|---------------|-----------|----------|----------------|
| Raspberry Pi 5 | 5 –∫–∞–Ω–∞–ª–æ–≤ | ~25‚Äì30 | 4 —è–¥—Ä–∞ √ó 80‚Äì90% |
| Raspberry Pi 4 | 5 –∫–∞–Ω–∞–ª–æ–≤ | ~12‚Äì15 | 4 —è–¥—Ä–∞ √ó 100% |
| –ü–ö (x86_64) | 5 –∫–∞–Ω–∞–ª–æ–≤ | 40‚Äì60 | 4 —è–¥—Ä–∞ √ó 60% |

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **`multiprocessing.shared_memory`**, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.

---

## üß∞ –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-----------|-----------|
| `SAMPLE_RATE` | 1 000 000 | –ß–∞—Å—Ç–æ—Ç–∞ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ (–ì—Ü) |
| `BLOCK_SIZE` | 32768 | –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞ –≤—ã–±–æ—Ä–æ–∫ |
| `CHANNELS` | 5 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤ KrakenSDR |
| `NUM_BLOCKS` | 8 | –ì–ª—É–±–∏–Ω–∞ –∫–æ–ª—å—Ü–µ–≤–æ–≥–æ –±—É—Ñ–µ—Ä–∞ |
| `UDP_PORT` | 5000 | –ü–æ—Ä—Ç –¥–ª—è –ø—Ä–∏—ë–º–∞ UDP-–ø–æ—Ç–æ–∫–∞ |

---

## üß© –î–∞–ª—å–Ω–µ–π—à–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- CAF —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `passive_radar.caf.caf.py`  
- –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã: CFAR ‚Üí Morphology ‚Üí Clustering ‚Üí Tracker  
- –î–ª—è headless —Ä–µ–∂–∏–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pipeline/realtime_pipeline.py`
